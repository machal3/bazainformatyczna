#include <bits/stdc++.h>

// ⢀⡴⠑⡄⠀⠀⠀⠀⠀⠀⠀⣀⣀⣤⣤⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
// ⠸⡇⠀⠿⡀⠀⠀⠀⣀⡴⢿⣿⣿⣿⣿⣿⣿⣿⣷⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠑⢄⣠⠾⠁⣀⣄⡈⠙⣿⣿⣿⣿⣿⣿⣿⣿⣆⠀⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⢀⡀⠁⠀⠀⠈⠙⠛⠂⠈⣿⣿⣿⣿⣿⠿⡿⢿⣆⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⢀⡾⣁⣀⠀⠴⠂⠙⣗⡀⠀⢻⣿⣿⠭⢤⣴⣦⣤⣹⠀⠀⠀⢀⢴⣶⣆
// ⠀⠀⢀⣾⣿⣿⣿⣷⣮⣽⣾⣿⣥⣴⣿⣿⡿⢂⠔⢚⡿⢿⣿⣦⣴⣾⠁⠸⣼⡿
// ⠀⢀⡞⠁⠙⠻⠿⠟⠉⠀⠛⢹⣿⣿⣿⣿⣿⣌⢤⣼⣿⣾⣿⡟⠉⠀⠀⠀⠀⠀
// ⠀⣾⣷⣶⠇⠀⠀⣤⣄⣀⡀⠈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀
// ⠀⠉⠈⠉⠀⠀⢦⡈⢻⣿⣿⣿⣶⣶⣶⣶⣤⣽⡹⣿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⠀⠉⠲⣽⡻⢿⣿⣿⣿⣿⣿⣿⣷⣜⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣷⣶⣮⣭⣽⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⣀⣀⣈⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠇⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⠀⠹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⠻⠿⠿⠿⠿⠛⠉


//        %%%%***+*###%####%#%%       
//      @@@##@%%%%%%#%@%%%%%@@@@@%    
//    @@@@@%@@@@@%%@@@@@@@@@@@@@@@@   
//   ##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
//  %%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
//  @%%#%%*==+*#@@@@@@@@@@@@@@@@@@##%%
//  @@@@#=::::::--=*#%%%%#+--=*#%#%@@@
//  @@@@*-::::::::--======----=#%@@@@@
//  @@@@*-:::::::::::::::::---*@@@@@@ 
//  @@@#-:::::---::::------:--+@@@@@@ 
// ==@@=::+#%@@@@%+++%@@@@@%+-=*%@@@@ 
// +-+#:::-+#%@@%+-:=@@@@@@@@#+=+@@+* 
// :-++::::::=++-::.:*%%%##*+=---@#+*+
// -:-=-::.::::::::.:--===--:::-=#%+* 
//  :::::::::::::..:.-+--------=+==-* 
//   ::-::::::------==++=-=====+=--+  
//     %-::::--::-+%#++++====++###@   
//      #::::-++==++****++==++*%      
//       +::-=---=+**###*++++*%       
//        -------=+**+++******        
//         ==---:----=+*####*         
//           ++++***#%%%%%            

using namespace std;

int ilosc_sukni , ilosc_parametrow , zapytania;
int a , b;

const int w_dupe_duzo = 1e9 + 69;
const int duzy_indeks = 2e5 + 69;

int main ()
{
    ios::sync_with_stdio (0);
    cin.tie (0);

    cin >> ilosc_sukni >> ilosc_parametrow >> zapytania;

    int rozmiar = 1 << ilosc_parametrow;
    vector<pair<int , int>> dp (rozmiar , { w_dupe_duzo, duzy_indeks });

    for (int i = 1; i <= ilosc_sukni; i++)
    {
        cin >> a >> b;
        int M = 0;

        for (int j = 0; j < b; j++)
        {
            int E;
            cin >> E;
            M |= (1 << (E - 1)); //tu skorzystałem z internetu (przyznaje się bez bicia)
        }

        if (dp[M].first > a || (dp[M].first == a && dp[M].second > i))
        {
            dp[M] = { a, i };
        }
    }

    for (int i = 0; i < ilosc_parametrow; i++)
    {
        for (int M = 0; M < rozmiar; M++)
        {
            if (M & (1 << i))
            {
                int Nmask = M ^ (1 << i);
                if (dp[M].first < dp[Nmask].first ||
                    (dp[M].first == dp[Nmask].first && dp[M].second < dp[Nmask].second))
                {
                    dp[Nmask] = dp[M];
                }
            }
        }
    }

    for (int i = 0; i < zapytania; i++)
    {
        int wczyt;
        cin >> wczyt;
        int maska = 0;
        for (int j = 0; j < wczyt; j++)
        {
            int x;
            cin >> x;
            maska |= (1 << (x - 1));
        }

        if (dp[maska].first == w_dupe_duzo)
        {
            cout << "NIE\n";
        }
        else
        {
            cout << dp[maska].second << "\n";
        }
    }
}